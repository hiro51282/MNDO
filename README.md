# AI連携マインドマップエディタ

React + ReactFlow + GPTを使用した、AI連携機能付きマインドマップエディタです。直感的な操作でマインドマップを作成し、AIアシスタントの力を借りてアイデアを拡張できます。

## 🚀 機能一覧

### 基本機能
- **ノード操作**: ノードの追加、編集、削除
- **エッジ管理**: ノード間の接続とスタイル変更
- **複数選択**: Ctrlキーで複数ノードを選択
- **レイアウト**: 縦方向・横方向のレイアウト切り替え
- **スタイリング**: ノードの色変更、エッジの線種変更

### AI連携機能
- **自然言語入力**: 「＜ノード名＞に子ノードを生成してください」形式でAIに指示
- **自動ノード生成**: AIが理解した内容に基づいてサブノードを自動生成
- **リアルタイム処理**: 入力と同時にAIが処理を実行

### 保存・読み込み機能
- **JSON形式保存**: マインドマップをJSONファイルとして保存
- **状態復元**: ノード、エッジ、レイアウト、色設定を完全復元
- **エラーハンドリング**: 保存失敗時の代替手段（クリップボード、コンソール出力）

### キーボードショートカット
- **Tab**: 選択中のノードにサブノードを追加
- **Ctrl**: 複数選択モード

## 🛠️ 技術スタック

- **フロントエンド**: React 18 + TypeScript
- **ビルドツール**: Vite
- **マインドマップ**: ReactFlow
- **状態管理**: Zustand
- **スタイリング**: TailwindCSS
- **AI連携**: OpenAI GPT API
- **アーキテクチャ**: カスタムフック + コンポーネント分割

## 📦 インストール

```bash
# リポジトリをクローン
git clone <repository-url>
cd mndo

# 依存関係をインストール
npm install

# 開発サーバーを起動
npm run dev
```

## 🔧 環境設定

### 必要な環境変数
```env
VITE_OPENAI_API_KEY=your_openai_api_key_here
```

### 依存関係
```json
{
  "react": "^18.2.0",
  "react-dom": "^18.2.0",
  "reactflow": "^11.10.1",
  "zustand": "^4.4.7",
  "tailwindcss": "^3.3.6"
}
```

## 🎮 操作方法

### 基本操作

#### ノード操作
1. **ノード追加**: 左上の「➕ 追加」ボタンをクリック
2. **ノード編集**: ノードをダブルクリックしてテキストを編集
3. **ノード削除**: ノードを右クリック → 「削除」を選択
4. **ノード選択**: ノードをクリック（Ctrlキーで複数選択）

#### エッジ操作
1. **エッジ作成**: ノードのハンドルをドラッグして別のノードに接続
2. **エッジ選択**: エッジをクリック
3. **エッジスタイル変更**: エッジを選択後、左上のエッジスタイルボタンで変更

#### レイアウト設定
1. **生成スタイル**: 左上の「生成スタイル」ドロップダウンで選択
   - 📏 縦方向: ノードが縦に配置
   - ↔️ 横方向: ノードが横に配置

#### スタイリング
1. **ノード色変更**: 
   - ノードを選択
   - カラーピッカーで色を選択
   - 「🎨 変更」ボタンをクリック
2. **エッジスタイル変更**:
   - エッジを選択
   - 「━ 通常」「┅ 破線」「⋯ 点線」ボタンで変更

### AI連携操作

#### AIアシスタント使用
1. **入力ボックス**: 画面左下のテキストボックスに指示を入力
2. **指示例**:
   - 「メインアイデアに子ノードを生成してください」
   - 「サブアイデア1に関連するアイデアを追加してください」
3. **実行**: Enterキーまたは送信ボタンをクリック
4. **結果**: AIが理解した内容に基づいてサブノードが自動生成

### 保存・読み込み操作

#### 保存
1. **保存ボタン**: 左上の「💾 保存」ボタンをクリック
2. **自動ダウンロード**: JSONファイルが自動的にダウンロード
3. **ファイル名**: `マインドマップ_YYYY-MM-DD_HH-MM-SS.json`形式

#### 読み込み
1. **読み込みボタン**: 左上の「📂 読み込み」ボタンをクリック
2. **ファイル選択**: 保存したJSONファイルを選択
3. **自動復元**: マインドマップの状態が完全に復元

### キーボードショートカット
- **Tab**: 選択中のノードにサブノードを追加
- **Ctrl + クリック**: 複数ノード選択
- **Delete**: 選択中のノードを削除

## 🏗️ プロジェクト構造

```
src/
├── components/
│   ├── MindMapRefactored.tsx    # メインのマインドマップコンポーネント
│   ├── ControlPanel.tsx         # 左上のコントロールパネル
│   ├── InfoPanel.tsx           # 右上の情報パネル
│   ├── AiAssistant.tsx         # 左下のAIアシスタント
│   └── CustomNode.tsx          # カスタムノードコンポーネント
├── hooks/
│   ├── useMindMap.ts           # マインドマップの状態管理
│   ├── useAiAssistant.ts       # AI連携機能
│   └── useKeyboardShortcuts.ts # キーボードショートカット
├── App.tsx                     # アプリケーションのエントリーポイント
└── main.tsx                    # Reactアプリケーションの初期化
```

## 🔧 カスタムフック詳細

### useMindMap
マインドマップの状態管理を担当するカスタムフック

**主要機能**:
- ノード・エッジの状態管理
- 選択状態の管理
- レイアウトスタイルの管理
- 保存・読み込み機能

**主要メソッド**:
```typescript
const {
  nodes, edges,                    // ノード・エッジの状態
  selectedNodes, selectedEdges,    // 選択状態
  layoutStyle, selectedNodeColor,  // 設定
  addNode, addSubNodes,           // ノード操作
  saveMindMap, openFileDialog,    // 保存・読み込み
  // ... その他のメソッド
} = useMindMap();
```

### useAiAssistant
AI連携機能を管理するカスタムフック

**主要機能**:
- OpenAI APIとの通信
- 自然言語の解析
- サブノードの自動生成

**使用方法**:
```typescript
const { aiInput, setAiInput, handleAiInput } = useAiAssistant(
  nodes,        // 現在のノード
  addSubNodes,  // サブノード追加関数
  setSelectedNodes // 選択状態更新関数
);
```

### useKeyboardShortcuts
キーボードショートカットを管理するカスタムフック

**対応キー**:
- Tab: サブノード追加
- Ctrl: 複数選択モード

## 🎨 UI/UX デザイン

### デザインコンセプト
- **モダンなガラスモーフィズム**: 半透明背景とブラー効果
- **直感的な操作**: アイコンと視覚的フィードバック
- **レスポンシブデザイン**: 様々な画面サイズに対応
- **アクセシビリティ**: キーボード操作とスクリーンリーダー対応

### カラーパレット
- **プライマリ**: 緑系（#4CAF50, #10B981）
- **セカンダリ**: 青系（#2196F3, #8B5CF6）
- **アクセント**: オレンジ系（#FF9800, #ff6b6b）
- **背景**: 白系（rgba(255,255,255,0.95)）

### アニメーション
- **ホバーエフェクト**: ボタンの浮き上がり効果
- **トランジション**: スムーズな状態変化
- **フィードバック**: 操作結果の視覚的確認

## 🚀 開発・デプロイ

### 開発環境
```bash
# 開発サーバー起動
npm run dev

# ビルド
npm run build

# プレビュー
npm run preview

# 型チェック
npm run type-check
```

### デプロイ
```bash
# 本番ビルド
npm run build

# 静的ファイルをデプロイ
# dist/ フォルダの内容をWebサーバーに配置
```

## 🐛 トラブルシューティング

### よくある問題

#### 保存機能が動作しない
1. **ブラウザのコンソール**を確認
2. **ポップアップブロッカー**を無効化
3. **ダウンロードフォルダ**の設定を確認

#### AI機能が動作しない
1. **APIキー**が正しく設定されているか確認
2. **ネットワーク接続**を確認
3. **OpenAI API**の利用制限を確認

#### パフォーマンスの問題
1. **大量のノード**がある場合は、ノード数を削減
2. **ブラウザのメモリ使用量**を確認
3. **不要なノード**を削除

### エラーログ
開発者ツールのコンソールでエラーログを確認できます。

## 📝 ライセンス

MIT License

## 🤝 コントリビューション

1. このリポジトリをフォーク
2. 機能ブランチを作成 (`git checkout -b feature/amazing-feature`)
3. 変更をコミット (`git commit -m 'Add amazing feature'`)
4. ブランチにプッシュ (`git push origin feature/amazing-feature`)
5. プルリクエストを作成

## 📞 サポート

問題や質問がある場合は、GitHubのIssuesページで報告してください。

---

**AI連携マインドマップエディタ** - アイデアを視覚化し、AIの力を借りて拡張する次世代のマインドマップツール
